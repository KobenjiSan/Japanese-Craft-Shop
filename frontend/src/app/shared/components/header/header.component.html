<!-- 
    NOTE: USE @IF (IF NEEDED, USE ANGULAR MATERIAL) 
    Angular CDK --- Layout Module (sub to breakpoint observer from .ts)
 -->
    
<!-- Desktop -->
<header class="hidden md:flex md:mt-0 flex-row justify-between py-2 mb-1 items-center px-4">
    <!-- Logo -->
    <h1 class="text-3xl lg:text-4xl min-w-fit">木漏れ日</h1>

    <!-- Desktop Nav -->
    <nav class="text-xl lg:text-2xl flex gap-4 lg:gap-6 hover:cursor-pointer ml-4">
        <a routerLink="/" [class]="router.url === '/' ? 'underline' : ''" class="nav-link">Home</a>
        <a routerLink="/shop" [class]="router.url === '/shop' ? 'underline' : ''" class="nav-link">Shop</a>
        <a routerLink="/about" [class]="router.url === '/about' ? 'underline' : ''" class="nav-link">About</a> 
    </nav>

    <!-- Searchbar -->
    <div class="w-full mx-6 relative">
        <input 
            type="text" 
            class="bg-brand-dark w-full px-3 text-xl lg:text-2xl focus:outline-none btn-border py-0.5 lg:py-1 "
            placeholder="Search for a Product"
            [value]="searchTerm()"
            (input)="onSearchInput($any($event.target).value)"
            (focus)="updateActiveSearch(true)"
            (blur)="updateActiveSearch(false)"
        />
        @if(searchTerm().length > 0 && (searchIsActive() || panelIsActive())){
            <div class="bg-brand-dark border border-brand-light shadow-md shadow-black p-2 max-h-60 overflow-y-auto mt-2 w-full absolute z-[999] flex flex-col gap-2"
                (pointerdown)="updateActivePanel(true)"
                (pointerup)="updateActivePanel(false)"
            >
                @if(products().length > 0){
                    @for(product of products(); track product.id){
                        <app-search-card 
                            [product]="product"
                            (closeSearchReq)="onSearchInput('')"
                        />
                    }
                } @else {
                    <span>This path shows no items — try another search.</span>
                }
            </div>
        }
    </div>

    <!-- User Menu -->
   
    @if(auth.isLoggedIn()){
        <div class="flex gap-4 mr-2">
            @if(auth.isAdmin()){
                <div class="w-32">
                    <div class="border border-brand-light pl-2 pr-4 py-1 w-fit">
                        <a routerLink="/admin" class="self-center flex gap-2">
                            <img src="shield_person_24dp_F5F1EB_FILL0_wght400_GRAD0_opsz24.svg">
                            <p class="font-bold text-lg">Admin</p>
                        </a>
                    </div>
                </div>
            } @else {
                <a routerLink="/favorites" class="self-center"> 
                    <img src="love_1.png" alt="Likes Page Link" class="w-16 nav-link hover:scale-90">
                </a>
                <a routerLink="/profile" class="self-center">
                    <img src="user_icon.png" class="w-14 nav-link hover:scale-90">
                </a>
            }
        </div>
    } @else {
        <div class="mr-2">
            <a routerLink="/login" 
                class="inline-block px-6 lg:px-8 py-0.5 text-xl lg:text-2xl btn-border btn-ux">
                Login
            </a>
        </div>
    }
    
</header>


<!-- Mobile -->
<div class="flex md:hidden flex-col gap-y-2 my-2 mx-2">
    <div class="flex flex-row">
        <div class="flex flex-row flex-1">
            <button class="text-4xl text-brand-light">
                ☰
            </button>
            <h1 class="self-center px-2 text-3xl">木漏れ日</h1>
        </div>
        <div class="flex flex-row self-center">
            <div class="mx-2">
                <a class="inline-block px-4 py-0.5 text-md btn-border btn-ux">Login</a>
            </div>
        </div>
    </div>
    <div class="w-full text-md mx-2 px-2 py-1 btn-border self-center">
        Search goes here*
    </div>
</div>